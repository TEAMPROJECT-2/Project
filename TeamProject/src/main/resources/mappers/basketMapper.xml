<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.itwillbs.mappers.basketMapper">

<!-- 	카트에 물건 삽입 -->
	<insert id="insertBasket">
		INSERT INTO  SHOPPING_BASKET(
					 SB_BASKET_NUM
					,SB_USER
					,SB_PROD_CODE
					,SB_COUNT
					,SB_PROD_PRICE
					,SHOPPING_BASKET_DATE
				   )
			VALUES(
				  (SELECT SB_BASKET_NUM
		       		 FROM   (SELECT IFNULL(MAX(CAST(SB_BASKET_NUM AS UNSIGNED)), 0) + 1 AS SB_BASKET_NUM
				 	   	       FROM SHOPPING_BASKET) A)
				   ,#{sbUser}
				   ,#{sbProdCode}
				   ,#{sbCount}
				   ,#{sbProdPrice}
				   ,#{shoppingBasketDate}
				    )

	</insert>

<!-- 	카트리스트  -->
	<select id="getBasketList" resultType="com.itwillbs.domain.BasketDTO" >
		   SELECT 	 SB_BASKET_NUM
					,SB_USER
					,SB_PROD_CODE
					,SB_COUNT
					,SB_PROD_PRICE
					,(SELECT PROD_L_PRODNM
					  FROM PRODUCT_LIST
					  WHERE PROD_L_CODE=SB_PROD_CODE
					  ) as sbProdNm
					,SB_TOTAL_PRICE
					,(SELECT PROD_L_QUANTITY
					  FROM PRODUCT_LIST
					  WHERE PROD_L_CODE=SB_PROD_CODE
					  ) as prodLQuantity
		     FROM   SHOPPING_BASKET
		    WHERE   SB_USER=#{sbUser}


	</select>

<!-- 	회원인지 아닌지 검사 -->
	<select id="getUser" resultType="com.itwillbs.domain.BasketDTO">
		SELECT *
		  FROM SHOPPING_BASKET
		 WHERE SB_USER=#{sbUser}
	</select>


</mapper>